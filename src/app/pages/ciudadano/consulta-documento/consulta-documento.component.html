<div id="page-header" class="bg-gradient bg-shadow">
    <div class="container">
        <div class="header-text clearfix">
            <div id="topcab"></div>
            <h3 class="pull-left mb-0">
                <span class="far fa-folder-open text-default menu-item-icon text-center fa-fw"></span> Ministerio de Trabajo, Empleo y Seguridad Social (MTESS)<br/>Servicio Nacional de Promoción Profesional (SNPP)
            </h3>
        </div>
    </div>
</div>

<div class="content pb-4">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <h4 class="mt-4 mb-4 text-primary">Descarga de Certificados de Cursos (SNPP)</h4>
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-xs-12">

                        <form #miForm="ngForm" class="mt-2">

                            <div class="form-group">
                                <label for="cedula"><strong> <i class="fa fa-info-circle"></i> Cédula </strong> <small>sin puntos</small></label>
                                <input type="text" [(ngModel)]="cedula" class="form-control" style="max-width: 200px;" id="cedula" name="cedula" placeholder="Ej. 123456" required>
                            </div>

                            <div class="form-group">
                                <label for="cod_alumno"><strong> <i class="fa fa-info-circle"></i> Cod. Alumno </strong> <small>(6 dígitos)</small></label>
                                <input type="text" [(ngModel)]="cod_alumno" class="form-control" style="max-width: 200px;" id="cod_alumno" name="cod_alumno" placeholder="Ej. a1a1a1" required>
                            </div>
                            
                            <re-captcha (resolved)="resolved($event)" siteKey="6Les3CAUAAAAAHePnS6Tnw0shRj6XWERG0WScS9s" [(ngModel)]="captcha" name="captcha" #captchaControl="ngModel" required></re-captcha>

                            <button class="btn btn-sm btn-default" (click)="refreshCaptcha()" *ngIf="captcha">
                                Recargar captcha
                            </button> 
                           
                            <div class="clearfix"><br/></div>

                            <div class="text-center" *ngIf="loading">
                                <img src="assets/img/misc/icon_loading.gif" alt="Procesando.." /> Procesando...
                            </div>
                            <div class="clearfix"><br/></div>

                            <button (click)="getCursosSnpp()"  class="btn btn-success btn-success-next" [disabled]="!miForm.form.valid || loading">
                                Descargar Certificado
                                <span class="fa fa-check"></span>            
                            </button>
                        </form>
                
                    </div>
                </div>
            </div> 
            
            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <div class="mt-3">
                    <img width="100%" style="border-radius: 16px;" src="assets/img/certtificados-entregados-en-el-SNPP.jpg" />
                </div>
                <div class="mt-2">
                    <div class="alert" style="margin-top:15px;background-color:#e2e6e8;color:#31708f;">
                        <strong><i class="fa fa-info-circle"></i></strong>  Para descargar el certificado, el SNPP entregará a cada alumno un cóodigo de descarga.
                    </div>
                </div>
            </div>
            
        </div>    
    </div>    
</div>

<div class="modal fade" id="modalView" tabindex="-1" role="dialog" aria-labelledby="modalView" aria-hidden="true">
    <div style="max-width:800px;" class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content p-4">

            <div class="modal-header">
                <h3 class="modal-title" id="modalView">
                    Lista de Certificados - SNPP
                </h3>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body row">

                <div class="col-lg-12 col-md-12 col-xs-12" style="padding:10px;" *ngFor="let curso of cursos?.data">
                    <ul class="list-group">
                        <a class="list-group-item list-group-item-action flex-column align-items-start" (click)="getCertificadoSnpp(cursos.key, curso)" style="cursor: pointer;">
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">{{curso.especialidad}}</h5>
                                <small>{{curso.fecha_fin}}</small>
                            </div>
                        </a>
                    </ul>
                </div>

                <div class="clearfix"></div>

                <div class="text-center" *ngIf="loading">
                    <img src="assets/img/misc/icon_loading.gif" alt="Cargando.." /> Procesando solicitud...
                </div>

                <div class="alert alert-danger" *ngIf="!resultado.status">
                    <i class="fa fa-info-circle"></i> {{resultado.message}}
                </div>
        
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
            </div>

        </div>
    </div>
</div>
