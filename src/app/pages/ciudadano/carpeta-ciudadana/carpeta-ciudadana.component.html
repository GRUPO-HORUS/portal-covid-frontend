<div id="page-header" class="bg-gradient bg-shadow">
    <div class="container">
        <div class="header-text clearfix">
            
            <div id="topcab"></div>

            <h3 class="pull-left mb-0">
                <span class="far fa-folder-open text-default menu-item-icon text-center fa-fw"></span> Carpeta Ciudadana
            </h3>

            <div class="text-center" *ngIf="ciudadano && (isDocument || isBuyConfirm)">
                <button type="button" class="btn btn-primary" *ngIf="!loading" style="margin-right:10px;" data-dismiss="modal" (click)="cancelGenerarDocumento()">
                    <i class="fa fa-angle-double-left"></i> Atrás
                </button>
            </div>

        </div>
    </div>
</div>


<div class="content pb-4" *ngIf="ciudadano && isTramitesEID">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-4 col-sm-12 col-xs-12">
                <menu-ciudadano></menu-ciudadano>
            </div>
            <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12" *ngIf="ciudadano">
                <h4 class="mt-4 mb-4 text-primary">Mis documentos en mi carpeta ciudadana</h4>
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-xs-12">

                        <div *ngFor="let data of dataCarpetaCiudadana | sort: 'key'; let i = index">

                            <div class="list-group-item list-group-item-action flex-column align-items-start mb-1" (click)="viewInfo(i)">
                                <div class="d-flex w-100 justify-content-between" style="cursor:pointer;">
                                    <h5 class="mb-1">{{ data.key }} - {{ data.name }}</h5>
                                    <span class="fa fa-angle-double-down pull-right" *ngIf="data.view"></span>
                                    <span class="fa fa-angle-double-right pull-right" *ngIf="!data.view"></span>
                                </div>
                            </div>

                            <div class="alert alert-warning" *ngIf="data.value.length <= 0 && data.view">
                                <p>No en encontraron datos en tu carpeta ciudadana de este tipo de documento</p>
                                <p>Podés generar el documento dando en
                                    <button type="button"  class="btn btn-info btn-sm" (click)="generarDocumento(data)">
                                        <i class="fa fa-file-import"></i>  Generar Documento
                                    </button> 
                                </p>
                            </div>
                            
                            <div *ngIf="data.value.length > 0 && data.view" class="pl-3 mb-3">
                                <div class="list-group" *ngFor="let result of data.value">
                                    <a style="padding:8px 20px;" class="list-group-item list-group-item-action flex-column align-items-start">
                                        <div class="d-flex w-100 justify-content-between">
                                            <small class="text-muted"><b>GENERADO POR:</b> {{ result.generadoPor }}</small>
                                            <small class="text-muted">{{ result.fechaGeneracion | date: 'dd/MM/yyyy HH:mm' }}</small>
                                        </div>
                                        <small class="text-muted">
                                            <b>SISTEMA:</b> {{ result.sistemaGenerador }}
                                            <button type="button" class="btn btn-info btn-sm" (click)="generarDocumentoHistorico(result)" style="cursor:pointer; font-size:12px; margin:3px;">
                                                <i class="fa fa-eye"></i>
                                            </button>
                                        </small>
                                    </a>
                                </div>
                                <div class="alert alert-info">
                                    <p>Podés generar el documento dando clic en
                                        <button type="button"  class="btn btn-info btn-sm" (click)="generarDocumento(data)">
                                            <i class="fa fa-file-import"></i>  Generar Documento
                                        </button>
                                    </p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>        
        </div>    
    </div>    
</div>


<!-- VIEW CONFIRM 
<div class="modal-dialog modal-dialog-centered" role="document"  *ngIf="ciudadano && isConfirm">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalSaludLabel">Confirmación</h5>
        </div>
        <div class="modal-body row m-2">
            ¿Desea generar el documento <span style="padding-left:5px;"><b>{{ documentData.name }}</b></span>?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="generarDocumento()">
                <i class="fa fa-check nav-link-icon"></i> Aceptar
            </button>
            <button type="button" class="btn btn-default" data-dismiss="modal"  (click)="cancelGenerarDocumento()">
                <i class="fa fa-close nav-link-icon"></i> Cancelar
            </button>
        </div>
    </div>
</div>
-->

<!-- VIEW BUY PROCESS -->
<div class="" role="document"  *ngIf="ciudadano && isBuyConfirm">
    <div class="buy-form">
        <header>
            <div class="col-lg-12">
                <h1 class="form-title-liquidacion">Liquidación</h1>
                <div style="padding-bottom:5px;">Consulta de datos de Cédula divolicial (Policía Nacional)</div>
                <div id="topcc"></div>
                <ul class="list-group">
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Nombre y Apellido</div>
                        <div class="col-lg-7 fs-12">{{nombreApellido}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Cédula</div>
                        <div class="col-lg-7 fs-12">{{nroDocumento}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Fecha de Solicitud</div>
                        <div class="col-lg-7 fs-12">{{fechaSolicitud}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Estado</div>
                        <div class="col-lg-7 fs-12">{{estadoSolicitud}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Nro. de Comprobante</div>
                        <div class="col-lg-7 fs-12">{{nroComprobantePago}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Fecha de Pago</div>
                        <div class="col-lg-7 fs-12">{{fechaPago}}</div>
                    </li>
                    <li class="list-group-item row p-1">
                        <div class="col-lg-5 fs-13 font-weight-bold">Lugar de Pago</div>
                        <div class="col-lg-7 fs-12">{{lugarPago}}</div>
                    </li>
                </ul>
            </div>
        </header>

        <form>           
            <!-- PASO 1 --> 
            <div class="input-section" [ngClass]="{ 'fold-up': secBuySection !== 'sec1', 'sec-fixed-1': secBuySection === 'sec1' }">
                <input class="email" type="text" [(ngModel)]="nroLiquidacion" disabled name="nroLiquidacion" placeholder="Nro. de Liquidación" />
                <div class="animated-button">
                    <span class="icon-paper-plane" *ngIf="!nroLiquidacion"><i class="fa fa-send"></i></span>
                    <span class="next-button email" *ngIf="nroLiquidacion" (click)="descargarTicket()" [ngClass]="{ 'cursor-pointer': nroLiquidacion > 0 }"><i class="fa fa-arrow-up"></i></span>
                </div>
                <div class="animated-button" style="background:#333;">
                    <span class="icon-paper-plane" (click)="formBuyComplete()"><i class="fa fa-credit-card"></i></span>                        
                </div>                
            </div>
            
            <!-- PASO - LIQUIDACION
            <div class="input-section" [ngClass]="{ 'fold-up': secBuySection !== 'sec2', 'folded': secBuySection !== 'sec2', 'sec-fixed-2': secBuySection === 'sec2' }">
                <div class="password" style="width: 100%; background: #f1f1f1; padding: 20px;">
                    <p style="font-size: 20px; font-weight: bold;"><strong>Datos de Liquidación</strong></p>
                    <p><strong>Nro. de Liquidación</strong> {{nroLiquidacion}} </p>
                    <p><strong>Cédula</strong> 1.123.465</p>
                    <p><strong>Fecha de Pago</strong> 30/08/2019</p>
                </div>
                <div class="animated-button">
                    <span class="icon-lock cursor-pointer" (click)="confirmNroLiquidacion()"><i class="fa fa-send"></i></span>
                    <span class="icon-paper-plane  cursor-pointer" (click)="cancelNroLiquidacion()"><i class="fa fa-close"></i></span>
                </div>
            </div> -->

            <!-- PASO - PAGO CON T.C -->
            <div class="input-section" [ngClass]="{ 'fold-up': secBuySection !== 'sec3', 'folded': secBuySection !== 'sec3', 'sec-fixed-3': secBuySection === 'sec3' }">
                <div class="password" style="width:100%; background:#f1f1f1; padding:8px 20px;">
                    <p style="font-size:18px; font-weight: bold;"><strong>Datos de la Tarjeta</strong></p>
                    <div class="form-group" style="margin: 4px;">
                        <label class="control-label" for="nro_tarjeta" style="font-size:12px;"><strong> <i class="fa fa-credit-card"></i> Nro. de Tarjeta </strong> </label>
                        <input type="text" name="nro_tarjeta" placeholder="Nro. de tarjeta" class="form-control input-custom-card" required>
                    </div>
                    <div class="form-group" style="margin: 4px;">
                        <div class="input-group">
                            <label class="control-label" style="font-size:12px;"><strong> <i class="fa fa-calendar"></i> MM/YY</strong> </label>
                            <label class="control-label" style="font-size:12px;margin-left: 130px;"><strong> <i class="fa fa-caret-square-o-right"></i> CVC </strong> </label>
                        </div>
                    </div>
                    <div class="form-group" style="margin: 4px;">
                        <div class="input-group">
                            <input type="text" class="form-control input-custom-card" placeholder="MM/YY"/>
                            <input type="text" class="form-control input-custom-card" placeholder="CVC"/>
                        </div>
                    </div>
                </div>
                <div class="animated-button">
                    <span class="icon-lock cursor-pointer" (click)="descargarDocumento()"><i class="fa fa-send"></i></span>
                    <span class="icon-paper-plane  cursor-pointer" (click)="viewBuyConfirm()"><i class="fa fa-close"></i></span>
                </div>
            </div>
            <div class="success" *ngIf="secBuySection == 'success'"> 
                <p>Cuenta creada</p>
            </div>
        </form>
    </div>
</div>

<!-- VIEW DOCUMENT -->
<div class="content fullscreen-container" *ngIf="ciudadano && isDocument">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 p-0" style="margin-top:5px !important;" *ngIf="ciudadano">
        <div style="height:100%; width:100%;">
            
            <div class="text-center" style="margin:40px;" *ngIf="loading">
                <img src="assets/img/misc/icon_loading.gif" alt="Cargando.." /> Procesando solicitud...
            </div>

            <div class="alert alert-danger" style="margin:40px;" *ngIf="!resultado.status">
                <i class="fa fa-info-circle"></i> {{resultado.message}}
            </div>

        </div>
    </div>
</div>